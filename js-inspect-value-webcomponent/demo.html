<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Inspect Value</title>
<script src="./InspectValue.js"></script>
<style>

inspect-value {
    display: block;
}

</style>
</head>
<body>
<inspect-value>Ololo Mememe</inspect-value>
<script type="text/javascript">

function add(...els) {
    const row = document.createElement('div');
    for (const el of els) {
        row.appendChild(el);
    }
    document.body.appendChild(row);
}

add(InspectValue.create());
add(InspectValue.create(null));
add(InspectValue.create(true));
add(InspectValue.create(false));
add(InspectValue.create(0));
add(InspectValue.create(1234));
add(InspectValue.create(13461347123582458n));
add(InspectValue.create("Ololo"));
// add(InspectValue.create(window));
add(InspectValue.create([0, 1, "Mememe", 1234n]));
add(InspectValue.create(new Array(100).fill('long string').join(' ')));
add(InspectValue.create(new Set([1,2,3,4])));
var m = new Map();
m.set({}, 'obj1');
m.set([], 'arr');
m.set({}, 'obj2');
add(InspectValue.create(m));
add(InspectValue.create({
    null: null,
    boolTrue: true,
    boolFalse: false,
    num0: 0,
    num1234: 1234,
    bigint: 13461347123582458n,
    str: "Ololo",
    arr: [0, 1, "Mememe", 1234n],
    [Symbol('sym')]: 'Symbol is here',
    Boolean: new Boolean(false),
}));
add(InspectValue.create([,,,,1234,5,6,7,8]));
add(InspectValue.create(new Date()));
add(InspectValue.create(new Date(NaN)));
add(InspectValue.create(window));
add(InspectValue.create(Symbol('sym')));

class Ololo {
    get ololo() {
        return 'mememe';
    }
}
add(InspectValue.create(new Ololo()));

const named = (param) => '1234' + param;
add(InspectValue.create(named));
add(InspectValue.create((param) => '5678' + param));
add(InspectValue.create(new Error(`Test error`)));

try {
    1n / 0n;
}
catch (err) {
    add(InspectValue.create(err));
}

add(InspectValue.create(new InspectValue.Getter(() => {
    return new InspectValue.InfoText(`You've clicked it`);
}), 'inline getter'));

let recursiveGetterFunction = () => {
    alert(`Returning same getter as a result`);
    return recursiveGetter;
};
let recursiveGetter = new InspectValue.Getter(recursiveGetterFunction);
add(InspectValue.create(recursiveGetterFunction));
add(InspectValue.create(recursiveGetter, 'recursive inline getter'));

let valueWrapper = new InspectValue.ValueWrapper(0);
add(InspectValue.create(valueWrapper));
valueWrapper._tmr = setInterval(() => { valueWrapper.set(valueWrapper.get() + 1) }, 1000);

(async () => {
    let asyncFunction = async (a) => {
        a = await a;
        await new Promise(resolve => setTimeout(resolve, 5000));
        if (isNaN(a)) {
            throw new Error(`Argument 'a' is NaN`);
        }
        return a + 1
    };
    add(InspectValue.create(asyncFunction));
    
    const prom0 = asyncFunction(0);
    add(InspectValue.create(prom0));
    
    const prom1 = asyncFunction(asyncFunction(0));
    add(InspectValue.create(prom1));
    const res1 = await prom1;
    add(InspectValue.create(res1));
    
    const prom2 = asyncFunction(NaN);
    add(InspectValue.create(prom2));
    try {
        // this would result in an error
        const res2 = await prom2;
        add(InspectValue.create(res2));
    }
    catch (err) {
        console.warn(`Expected error`, err);
    }
})();


</script>
</body>
</html>